<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: Test::Mini::TestCase</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (T)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../Test.html" title="Test (module)">Test</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Mini.html" title="Test::Mini (class)">Mini</a></span></span>
     &raquo; 
    <span class="title">TestCase</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Test::Mini::TestCase
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Test::Mini::TestCase</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/Test/Mini/TestCase.pm</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Base class for Test::Mini test cases.
</p>


  </div>
</div>
<div class="tags">
  
  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="Runner.html" title="Test::Mini::Runner (class)">Runner</a></span></li>
    
  </ul>

</div>


  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new-class_method" title="new (class method)">+ <strong>new</strong>($class, %args) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Constructor.
</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-instance_method" title="#run (instance method)">- <strong>run</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Runs the test specified at construction time.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup-instance_method" title="#setup (instance method)">- <strong>setup</strong>($self) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Test setup behavior, automatically invoked prior to each test.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#teardown-instance_method" title="#teardown (instance method)">- <strong>teardown</strong>($self) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Test teardown behavior, automatically invoked following each test.
</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="new-class_method">
  
    + <strong>new</strong>($class, %args) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Constructor.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>%args</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Initial state for the new instance.
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <h3>Options Hash (<tt>%args</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>Object</tt>)</span>
          <span class="name">name</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'><p>
The specific test this instance should run.
</p>
</div>
        </tr>
      
    </ul>
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19
20</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/Test/Mini/TestCase.pm', line 17</span>

<span class="kw">sub</span> <span class="val">new</span> {
    <span class="kw">my</span> (<span class="ivar">$class</span>, <span class="ivar">%args</span>) = <span class="ivar">@_</span>;
    <span class="kw">return</span> <span class="kw">bless</span> { <span class="ivar">%args</span>, <span class="symbol">passed </span>=> 0 }, <span class="ivar">$class</span>;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="run-instance_method">
  
    - <strong>run</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Runs the test specified at construction time.  This method is responsible
for invoking the setup and teardown advice for the method, in addition to
ensuring that any fatal errors encountered by the program are suitably
handled.  Appropriate diagnostic information should be sent to the supplied
<tt>$runner</tt>.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="Runner.html" title="Test::Mini::Runner (class)">Test::Mini::Runner</a></span></tt>)</span>
      
      
        <span class='name'>$runner</span>
      
      
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'></span>
      
      
      
      
        
        <div class='inline'><p>
The number of assertions called by this test.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/Test/Mini/TestCase.pm', line 70</span>

<span class="kw">sub</span> <span class="val">run</span> {
    <span class="kw">my</span> (<span class="ivar">$self</span>, <span class="ivar">$runner</span>) = <span class="ivar">@_</span>;
    <span class="kw">my</span> <span class="ivar">$e</span>;
    <span class="kw">my</span> <span class="ivar">$test</span> = <span class="ivar">$self</span><span class="kw">-></span>{<span class="symbol">name</span>};

    <span class="kw">eval</span> {
        <span class="kw">local</span> <span class="ivar">$SIG</span>{<span class="symbol">__DIE__</span>} = <span class="kw">sub</span> {
            <span class="comment"># Package declaration for isolating the callstack.</span>
            <span class="comment"># @api private</span>
            <span class="kw">package</span> <span class="val">Test::Mini::SIGDIE</span>;

            <span class="kw">die</span> <span class="ivar">$@</span> <span class="kw">if</span> UNIVERSAL::isa(<span class="ivar">$@</span>, <span class="tstring">'Test::Mini::Exception'</span>);

            (<span class="kw">my</span> <span class="ivar">$msg</span> = <span class="tstring">"<span class="ivar">@_</span>"</span>) =~ <span class="regexp"><span class="kw">s</span>/ at .*? line <span class="const">\d</span>+<span class="const">\.</span><span class="const">\n</span>$</span><span class="regexp">//</span>;
            <span class="kw">my</span> <span class="ivar">$error</span> = Test::Mini::Exception<span class="kw">-></span>new(
                <span class="symbol">message        </span>=> <span class="tstring">"<span class="ivar">$msg</span><span class="const">\n</span>"</span>,
                <span class="symbol">ignore_package </span>=> [<span class="tstring">qw/ Test::Mini::SIGDIE Carp /</span>],
            );

            <span class="kw">my</span> <span class="ivar">$me</span> = <span class="ivar">$error</span><span class="kw">-></span>trace<span class="kw">-></span>frame(0);
            <span class="kw">if</span> (<span class="ivar">$me</span><span class="kw">-></span>{<span class="symbol">subroutine</span>} <span class="kw">eq</span> <span class="tstring">'Test::Mini::TestCase::__ANON__'</span>) {
                <span class="ivar">$me</span><span class="kw">-></span>{<span class="symbol">subroutine</span>} = <span class="tstring">'die'</span>;
                <span class="ivar">$me</span><span class="kw">-></span>{<span class="symbol">args</span>} = [ <span class="ivar">$msg</span> ];
            }

            <span class="kw">die</span> <span class="ivar">$error</span>;
        };

        <span class="ivar">$self</span><span class="kw">-></span>setup();
        <span class="ivar">$self</span><span class="kw">-></span><span class="ivar">$test</span>();
        <span class="ivar">$self</span><span class="kw">-></span>{<span class="symbol">passed</span>} = 1;

        <span class="kw">die</span> <span class="tstring">'No assertions called'</span> <span class="kw">unless</span> count_assertions();
    };

    <span class="kw">if</span> (<span class="ivar">$e</span> = Exception::Class<span class="kw">-></span>caught()) {
        <span class="ivar">$self</span><span class="kw">-></span>{<span class="symbol">passed</span>} = 0;

        <span class="kw">if</span> (<span class="ivar">$e</span> = Exception::Class<span class="kw">-></span>caught(<span class="tstring">'Test::Mini::Exception::Skip'</span>)) {
            <span class="ivar">$runner</span><span class="kw">-></span>skip(<span class="kw">ref</span> <span class="ivar">$self</span>, <span class="ivar">$test</span>, <span class="ivar">$e</span>);
        }
        <span class="kw">elsif</span> (<span class="ivar">$e</span> = Exception::Class<span class="kw">-></span>caught(<span class="tstring">'Test::Mini::Exception::Assert'</span>)) {
            <span class="ivar">$runner</span><span class="kw">-></span>fail(<span class="kw">ref</span> <span class="ivar">$self</span>, <span class="ivar">$test</span>, <span class="ivar">$e</span>);
        }
        <span class="kw">elsif</span> (<span class="ivar">$e</span> = Exception::Class<span class="kw">-></span>caught(<span class="tstring">'Test::Mini::Exception'</span>)) {
            <span class="ivar">$runner</span><span class="kw">-></span>error(<span class="kw">ref</span> <span class="ivar">$self</span>, <span class="ivar">$test</span>, <span class="ivar">$e</span>);
        }
    }

    <span class="kw">eval</span> {
        <span class="ivar">$self</span><span class="kw">-></span>teardown();
        <span class="ivar">$runner</span><span class="kw">-></span>pass(<span class="kw">ref</span> <span class="ivar">$self</span>, <span class="ivar">$self</span><span class="kw">-></span>{<span class="symbol">name</span>}) <span class="kw">if</span> <span class="ivar">$self</span><span class="kw">-></span>{<span class="symbol">passed</span>};
    };
    <span class="kw">if</span> (<span class="ivar">$e</span> = Exception::Class<span class="kw">-></span>caught()) {
        <span class="ivar">$runner</span><span class="kw">-></span>error(<span class="kw">ref</span> <span class="ivar">$self</span>, <span class="ivar">$test</span>, <span class="ivar">$e</span>);
    }

    <span class="kw">return</span> reset_assertions();
}

1;</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="setup-instance_method">
  
    - <strong>setup</strong>($self) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Test setup behavior, automatically invoked prior to each test.  Intended to
be overridden by subclasses.
</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h3>Examples:</h3>
    
      <h4><div class='inline'></div></h4>
      <pre class="example code"><span class="kw">package</span> <span class="val">TestSomething</span>;
<span class="kw">use</span> base 'Test::Mini::TestCase';

<span class="kw">use</span> Something;

<span class="kw">sub</span> <span class="val">setup</span> { <span class="ivar">$obj</span> = Something<span class="kw">-></span>new(); }

<span class="kw">sub</span> <span class="val">test_can_foo</span> {
    assert_can(<span class="ivar">$obj</span>, <span class="tstring">'foo'</span>);
}</pre>
    
  </div>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="#teardown-instance_method" title="Test::Mini::TestCase#teardown (method)">#teardown</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/Test/Mini/TestCase.pm', line 38</span>

<span class="kw">sub</span> <span class="val">setup</span> {
    <span class="kw">my</span> (<span class="ivar">$self</span>) = <span class="ivar">@_</span>;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="teardown-instance_method">
  
    - <strong>teardown</strong>($self) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Test teardown behavior, automatically invoked following each test. 
Intended to be overridden by subclasses.
</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h3>Examples:</h3>
    
      <h4><div class='inline'></div></h4>
      <pre class="example code"><span class="kw">package</span> <span class="val">Test</span>;
<span class="kw">use</span> base 'Test::Mini::TestCase';

<span class="kw">sub</span> <span class="val">teardown</span> { <span class="kw">unlink</span> <span class="tstring">'foo.bar'</span> }

<span class="kw">sub</span> <span class="val">test_touching_files</span> {
    <span class="tstring">`touch foo.bar`</span>;
    assert(<span class="kw">-f</span> <span class="tstring">'foo.bar'</span>);
}</pre>
    
  </div>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="#setup-instance_method" title="Test::Mini::TestCase#setup (method)">#setup</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/Test/Mini/TestCase.pm', line 57</span>

<span class="kw">sub</span> <span class="val">teardown</span> {
    <span class="kw">my</span> (<span class="ivar">$self</span>) = <span class="ivar">@_</span>;
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Feb 10 23:19:18 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.4 (ruby-1.8.7).
</div>

  </body>
</html>